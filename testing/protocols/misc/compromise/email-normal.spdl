// E-mail protocol normal
// Sun et al. Secure E-mail protocols providing Perfect Forward Secrecy

protocol email-normal(B,A)
{
	role B
	{
		fresh M: Nonce;
		fresh k: SessionKey;

		send_1(B,A, A, { k }pk(A), { M }k );
		claim(B, Secret, M);
		claim(B, SKR, k);
	}
	role A
	{
		var M: Nonce;
		var k: SessionKey;

		recv_1(B,A, A, { k }pk(A), { M }k );
		claim(A, Secret, M);
		claim(A, SKR, k);
	}
}

